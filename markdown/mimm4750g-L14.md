# MIMM4750G
## The coalescent
<img src="https://imgs.xkcd.com/comics/strengths_and_weaknesses.png" width="800px"/>

---

# Bayesian inference

* We spent the previous lecture and lab talking about and learning work with Bayesian methods.
* Bayesian inference is extremely useful for dealing with complex models like *trees*.
* A tree is a model that is made up of branching patterns and branch lengths.  This is a lot of parameters!
* The MLE of the tree is only one point in a *massive* space of all possible trees.

---

# Priors on trees

* We've learned about priors on continuous variables.  There are also priors for discrete variables.
* What about trees?
* We'd need some way of arranging trees along a meaningful axis in order to draw a prior distribution the usual way.

<img src="/img/silly-tree-prior.png" width="500px"/>

---

# Common ancestry

* A tree is a model of common ancestry.
* How far back in time do we have to go to reach the common ancestor of two people we pick at random?
* Assumptions:
  1. Every individual has the same chance of contributing offspring (no selection).
  2. The size of the population does not change.
  3. Everyone reproduces at the same time and dies (discrete generations).

---

<section data-state="coalescent-slide">
    <h1>The coalescent</h1>
    <div id="coalescent" class="fig-container"
         data-fig-id="fig-coalescent"
         data-file="/include/coaltrace.html"
         style="height:600px">
    </div>
    <small><small><a href="http://bedford.io/projects/coaltrace/">coaltrace</a> by Trevor Bedford</small></small>
</section>

---

# The coalescent

* To make things simple, assume everyone has one and only one ancestor (pathogens!).
* The probability that two *randomly sampled* individuals have a common ancestor in the previous generation is $1/N$, where $N$ is the population size.
* Every individual is equally likely to be the ancestor.

---

# Geometric distribution

* The expected number of generations we go back is described by a geometric distribution:
  $$P(t) = (1-p)^{t-1} p$$
  
* $t-1$ "failures" until a success.

* $p=1/N$, gives us:
  $$P(t) = \left(1-\frac{1}{N}\right)^{t-1} \frac{1}{N}$$

---

# Mean time to ancestor

* The average for the geometric distribution is simply $1/p$.
* Since $p=1/N$, we expect to go $N$ generations until we reach the common ancestor of two random individuals.
* *We can learn something about the entire population from sampling a tiny number of individuals.*

---

# Sampling more than two

* If we sample $n$ individuals at random, then there are 

  $${n\choose 2} = \frac{n!}{(n-2)!2!} = \frac{n(n-1)}{2} \text{ pairs.}$$

* We multiply the $p$ by this amount (go back in time until *any* pair coalesces).

* The *total* mean time to get to the ancestor of all *n* individuals:
  
  $$2N\sum_{k=n}^{2} \frac{1}{k(k-1)} = 2N$$


---


